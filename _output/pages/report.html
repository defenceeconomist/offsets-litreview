<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Defence Economics">
<meta name="dcterms.date" content="2026-01-29">

<title>Defence Offsets and Alliance Integration – Offsets</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-42ed7287b56c5c583e2c2463c9cf4916.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar docked quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../pages/report.html">Report</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Offsets</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/report.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Report</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pages/explorer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CMO Explorer</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Methods</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analysis/normalise-tags.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Normalise tags</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analysis/tag-dendrograms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tag dendrograms</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Synthesis</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../synthesis/rq1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">RQ1 Synthesis</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a>
  <ul class="collapse">
  <li><a href="#research-questions" id="toc-research-questions" class="nav-link" data-scroll-target="#research-questions"><span class="header-section-number">1.1</span> Research Questions</a></li>
  </ul></li>
  <li><a href="#conceptual-framework" id="toc-conceptual-framework" class="nav-link" data-scroll-target="#conceptual-framework"><span class="header-section-number">2</span> Conceptual Framework</a>
  <ul class="collapse">
  <li><a href="#offsets-as-an-instrument-of" id="toc-offsets-as-an-instrument-of" class="nav-link" data-scroll-target="#offsets-as-an-instrument-of"><span class="header-section-number">2.1</span> Offsets as an Instrument of</a></li>
  <li><a href="#mechanisms-linking-offsets-to-alliance-outcomes" id="toc-mechanisms-linking-offsets-to-alliance-outcomes" class="nav-link" data-scroll-target="#mechanisms-linking-offsets-to-alliance-outcomes"><span class="header-section-number">2.2</span> Mechanisms Linking Offsets to Alliance Outcomes</a></li>
  </ul></li>
  <li><a href="#background" id="toc-background" class="nav-link" data-scroll-target="#background"><span class="header-section-number">3</span> Background</a></li>
  <li><a href="#findings" id="toc-findings" class="nav-link" data-scroll-target="#findings"><span class="header-section-number">4</span> Findings</a>
  <ul class="collapse">
  <li><a href="#rq1" id="toc-rq1" class="nav-link" data-scroll-target="#rq1"><span class="header-section-number">4.1</span> RQ1</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">5</span> References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Defence Offsets and Alliance Integration</h1>
<p class="subtitle lead">When Industrial Participation Helps—and Hurts—Partnerships</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Defence Economics </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 29, 2026</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="introduction" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">1</span> Introduction</h2>
<p>Defence offsets and “industrial participation” (IP) policies are most often framed as instruments of national industrial strategy: mechanisms through which states seek to secure domestic workshare, technology transfer, skills development, or employment in return for awarding major defence contracts to foreign suppliers. In allied settings — particularly within NATO — these policies also have a strategic dimension. By shaping where defence equipment is produced, how it is supported in service, and which firms and supply chains are embedded in programmes, offset and IP arrangements influence the industrial and logistical foundations that underpin interoperability, readiness and security of supply. As NATO places growing emphasis on defence industrial capacity, multinational procurement, materiel standardisation and the resilience of supply chains, the interface between procurement and industry is not peripheral to alliance strategy but a core enabler of deterrence and collective defence.</p>
<p>NATO defines interoperability as the ability of Allied forces to act together coherently, effectively and efficiently in pursuit of shared tactical, operational and strategic objectives, with standardisation framed as a means to achieve the compatibility, interchangeability and commonality required to enable that interoperability. In this context, the design of offset and IP policies — including decisions about manufacturing location, technology sharing, sustainment arrangements and the access and sharing of standards and data — can plausibly affect Allied operational effectiveness, the speed and credibility of reinforcement, and resilience in crisis or conflict. These are precisely the kinds of alliance-relevant outcomes examined in this study.</p>
<p>Historically, the United Kingdom has not operated a formal, enforceable offset regime within its defence procurement framework. Industrial participation commitments by foreign suppliers have generally been voluntary, informal or programme-specific rather than grounded in a standing policy requiring defined industrial outcomes. This approach has differed from that of many allied nations where offset or IP requirements are embedded in procurement policy and contractual practice, obliging overseas suppliers to reinvest a proportion of contract value into the domestic economy through industrial, technological or skills-related activities.</p>
<p>Under the government’s <em>Defence Industrial Strategy (2025): Making Defence an Engine for Growth</em>, the Ministry of Defence signalled its intention to explore the introduction of a formalised offset or industrial participation policy. In the UK context, offsets and industrial participation are being conceived as economic commitments by foreign defence suppliers to generate measurable benefits for the UK industrial base. These benefits might include UK-based manufacturing or co-production, technology transfer, integration of UK small and medium-sized enterprises (SMEs) into supply chains, workforce skills development and collaborative research and development. The articulation of this definition reflects an effort to align defence expenditure with the government’s broader objective of harnessing defence spend as an “engine for growth”, increasing economic returns across regions and sectors critical to national security.</p>
<p>At the same time, there is no single, universally accepted definition of defence offsets. Academic and policy literature emphasises the diversity of arrangements captured under the term. The U.S. Department of Commerce, for example, describes offsets in defence trade as industrial compensation practices required by purchasing governments as a condition of buying defence goods or services from non-domestic sources, encompassing activities such as co-production, licensed production, subcontracting, technology transfer and procurement from local industry. Building on this broader literature, Anicetti defines offsets as <strong>compensatory economic, industrial, technological or strategic benefits, negotiated and contractually agreed between buyer states and foreign suppliers, typically expressed as a percentage of the value of the defence contract</strong>.</p>
<p>These definitions highlight the central tension explored in this report. Offsets and industrial participation are designed to advance national industrial and economic objectives, yet in alliance contexts they also shape patterns of industrial integration, technology sharing and supply-chain interdependence among partners. As a result, offset policies may, depending on their design, either reinforce alliance integration — for example by embedding firms in shared production and sustainment networks that support common standards — or pull in the opposite direction by fragmenting supply chains, duplicating capabilities or constraining standardisation and interoperability. Understanding when and how these different effects arise is therefore essential to assessing the alliance implications of emerging UK offset policy.</p>
<section id="research-questions" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="research-questions"><span class="header-section-number">1.1</span> Research Questions</h3>
<p>The research questions as originally posed are:</p>
<ol type="1">
<li>How can an offset policy support a NATO-aligned defence strategy?</li>
<li>How can offsets support strong international partnerships and industrial collaboration with strategic allies?</li>
<li>What risks do offsets pose to enabling or sustaining strategic partnerships?</li>
<li>Are there countries that demonstrate strong industrial collaboration with strategic partners while retaining an offset policy?</li>
<li>Are there countries where offset policies have hindered strategic partnerships or alliance integration?</li>
</ol>
<p>The five research questions are well chosen for the policy problem you are trying to solve: they focus on the tension between national industrial participation goals (offsets) and the demands of alliance-centred defence planning (interoperability, readiness, and trusted industrial collaboration). They also sensibly include both “what can work” and “what can go wrong”, which helps avoid a one-sided evidence base. That said, the questions are currently framed at a high level and use terms that are intuitive in policy debate but unevenly used in the research literature. Phrases such as “NATO-aligned”, “strategic partners”, “strong partnerships”, and “hindered integration” are rarely stated explicitly in academic titles or abstracts, and can be interpreted in very different ways. If the questions remain this broad and value-laden, the review risks pulling in a wide range of material that is hard to compare, while still missing key studies simply because they use different language (for example, “industrial cooperation”, “industrial participation”, “industrial and regional benefits”, “workshare”, or “local content” rather than “offsets”).</p>
<p>A second issue is that several questions imply cause-and-effect—offsets “support” or “hinder” partnerships—without clearly defining what counts as support or hindrance. In practice, much of the available evidence is descriptive, legal, or case-based and may only show associations or reported frictions, not clear causal impacts. Without more specific outcomes, it becomes difficult to draw defensible conclusions beyond general statements. “Strong partnership” could mean many things: smooth access to technology, programme participation, shared sustainment arrangements, stable export relationships, or political trust. Likewise, “alliance integration” could refer to operational interoperability, standardisation, procurement integration, or wider political alignment. These are not interchangeable. A rapid evidence synthesis will be stronger if it focuses on observable indicators (for example: co-development/co-production arrangements, supply-chain integration, shared maintenance and sustainment, adoption of common standards, documented procurement delays or supplier withdrawals, export-control deadlocks, or corruption investigations linked to offset activity).</p>
<p>The comparative “case” questions are the most promising, but they also need clearer criteria. Asking whether there are countries that combine offsets with strong strategic collaboration is a good way to ground the review in real-world experience. However, unless “strong industrial collaboration” is defined, the output can easily become a loose list of countries rather than an evidence-backed comparison. Collaboration can range from minor subcontracting through to licensed production, joint ventures, co-development, and shared sustainment—each with very different implications for sovereignty, security of supply, and interoperability. Similarly, “retaining an offset policy” could mean a formal mandatory regime, a voluntary industrial participation approach, or simply negotiated workshare expectations. Being explicit about what types of offset policy and what depth of collaboration you are looking for will make the case mapping more credible and repeatable.</p>
<p>To strengthen the review, the questions should be reframed slightly so they are easier to “find” in the literature and easier to answer with available evidence. A practical way to do this is to shift the emphasis from broad claims (“offsets support NATO alignment”) to mechanisms and conditions (“under what conditions and through what mechanisms do industrial participation requirements help or hinder alliance-relevant outcomes?”). That retains your policy intent but gives the review a clearer structure: what is the mechanism (technology transfer, local production, supply-chain diversification, governance design), what is the context (mandatory vs voluntary, direct vs indirect offsets, export-control environment, multinational programme setting), and what is the outcome (interoperability, timeliness, trust, cost, or corruption risk). This also makes it easier to handle contested evidence: where studies disagree, you can explain how different contexts or policy designs may account for different outcomes rather than forcing a single verdict.</p>
<p>Finally, there is a retrieval and bias risk that is worth flagging upfront in your report. If the search strategy requires papers to mention “alliance” or “partnership” alongside “offsets,” it will miss a lot of relevant material, because many offset studies talk about industrial policy, technology transfer, and governance without using alliance language. Conversely, alliance interoperability literatures often discuss procurement and industrial cooperation without using the term “offset”. The recommendation is to use a two-stage approach: first retrieve the broader offset/industrial participation evidence and the industrial cooperation evidence separately (including synonyms), then screen and tag it against your NATO-first operational concept. This is more realistic for a rapid synthesis and reduces the chance that “no results” is mistaken for “no evidence”.</p>
<p>Overall, the recommended refinements are modest but important: define key terms in plain operational language; specify a short set of measurable outcomes; treat “support” and “hindrance” as mechanisms and conditions rather than assumed effects; and use a case selection rubric so the positive and negative examples are comparable. These changes will make the evidence synthesis easier to execute, more transparent to readers, and more useful for decisions about whether (and how) an offset policy could be compatible with a NATO-first defence posture.</p>
<ol type="1">
<li><p><strong>Alliance relevance and mechanisms</strong> Through what mechanisms do offset or industrial participation policies affect alliance-relevant outcomes such as interoperability, standardisation, security of supply, readiness, and the ability to contribute rapidly to NATO operations?</p></li>
<li><p><strong>Conditions for durable collaboration</strong> Under what conditions do offsets lead to durable industrial collaboration with allies and close partners—such as co-development, co-production, licensed production, shared sustainment/MRO, or integration into trusted supply chains?</p></li>
<li><p><strong>Risks and mitigation</strong> What partnership risks are most commonly associated with offsets (e.g., corruption vulnerability, export-control friction, programme fragmentation, market distortion, cost/schedule impacts), and what mitigation measures or governance designs are reported to reduce these risks?</p></li>
<li><p><strong>Positive comparative cases</strong> Which countries combine (a) a continuing offset/industrial participation policy and (b) high levels of allied programme integration and industrial collaboration, and what design features of their policies appear to enable that coexistence?</p></li>
<li><p><strong>Negative or mixed comparative cases</strong> Which countries exhibit offset-related frictions that undermine partnership or alliance integration outcomes (e.g., deal failure, supplier withdrawal, interoperability delays, diplomatic disputes), and what policy design features appear implicated?</p></li>
</ol>
</section>
</section>
<section id="conceptual-framework" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="conceptual-framework"><span class="header-section-number">2</span> Conceptual Framework</h2>
<section id="offsets-as-an-instrument-of" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="offsets-as-an-instrument-of"><span class="header-section-number">2.1</span> Offsets as an Instrument of</h3>
</section>
<section id="mechanisms-linking-offsets-to-alliance-outcomes" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="mechanisms-linking-offsets-to-alliance-outcomes"><span class="header-section-number">2.2</span> Mechanisms Linking Offsets to Alliance Outcomes</h3>
</section>
</section>
<section id="background" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="background"><span class="header-section-number">3</span> Background</h2>
</section>
<section id="findings" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="findings"><span class="header-section-number">4</span> Findings</h2>
<section id="rq1" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="rq1"><span class="header-section-number">4.1</span> RQ1</h3>
</section>
</section>
<section id="references" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="references"><span class="header-section-number">5</span> References</h2>
<div id="refs" role="list">

</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>